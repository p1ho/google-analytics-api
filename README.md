# README #

Updated 2018-08-09

## What is this repository for? ##

  Even though Google has a php framework for making requests to Google Analytics API, the process as well as the data returned is still quite convoluted. This "add-on" encapsulates the framework and make Google Analytics API call more intuitive, and transform returned data to one that is organized more clearly.

## How do I get set up? ##

### Get Google's php framework ###

First install Google's php framework through composer with the following code at your web server directory.

```composer require google/apiclient:^2.0```

After successful installation, drag all files in this repository to the root directory of the Google framework installation. (same directory as folder "vendor")

### Authentication ###

Because this API requires authentication, some credential files will have to be created:

If your current logged-in account on Google has access to the Google Analytics data you would like to fetch from, go to [Google Cloud Console](https://console.cloud.google.com/) and create a new project.

After you create the project, the screen should prompt you to create credentials, you need to create an API key (for fetching metadata for validation), and a service account (for actually getting Google Analytics Data)

Even though the service account is tied to the project, it is not tied to your Google account, so access to Google Analytics does not automatically transfer over to the service account. You need to add the service account email address (e.g. account-name@foo-bar-123456.iam.gserviceaccount.com) to the user group in the Google Analytics boards as well.

2 json files are needed:

* api_key.json: a json file with key "api-key" and the actual API key you just created on Google Cloud Console

* service\_account\_credentials.json: a json file automatically generated by Google Cloud Console. After you create the account, you should be able to download it from the interface. Rename it to service_account_credentials.json and put it with other files.

In the config_ga.ini, set the absolute directories for 'api_key.json' and 'service\_account\_credentials.json'

For security purposes (because config file contains directory to the secret files), config_ga.ini can now be put anywhere (recommended to be placed above the root), but you have to specify where it is in the ga_config.php

### Running the Demo ###

To fetch from Google Analytics API, you need the View ID of the site. Go to your Google Analytics Dashboard --> Admin --> View Settings to see the View ID, and copy that into:

* line 7 in demo\_for\_api.php (demo for using GA_API.php)

* line 86 in demo\_for\_4\_stages.php (demo for using Validator, RequestsPackage, ReportsGetter, ReportAssembler)

If these files are already running on a localhost or is on a webserver, it should be viewable in your web browser at the appropriate URL if all previous steps are done.

### Additional Notes ###

1. Inside the folder "ga-dim-met-lib", the file "compatible\_metrics\_dimensions.json" is the longest metrics list I could get without Google API throwing an error (not all metrics are compatible with each other). I used data in this file for testing a lot.

## Contact ##

Feel free to contact me at hopokuan@umich.edu
